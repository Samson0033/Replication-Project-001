noprint;
supres @smpl;
options limwarn=0;
freq n;
smpl 1 98;

read(file='allgeog98.dat') codesj geogt geog1 geog2 
geog3 geog4 geog5 geog6 geog7 geog8 geog9 
geog10 geog11 geog12 geog13 geog14;
read(file='area98.dat') code area;
read(file='popwork98.dat') code pop work;
read(file='info98.dat') code1 code2 code3 
gdpw85 gdpw60 avinv ngdelta avsch open;
read(file='hj98.dat') code1 code2 alnky phis lna;

genr lwork = log(work);
genr larea = log(area);
genr lgdpw85 = log(gdpw85);
genr lgdpw60 = log(gdpw60);
genr lgrow = lgdpw85 - lgdpw60;

inst phis c open lwork larea invr c geogt lwork larea;
copy @vcov sigma;

load(type=general,nrow=4,ncol=14) dbda ;
      -0.00046712       0.31035       0.23023       0.71328      -1.04125 
        -0.080381      -1.76083       1.60349       1.42372       0.35485 
          1.19886       1.75405       2.30733       3.69826 
      1.87128D-06    -0.0012432   -0.00092228    -0.0028574     0.0041712 
       0.00032201     0.0070538    -0.0064235    -0.0057034   
        -0.0014215 
       -0.0048026    -0.0070267    -0.0092431     -0.014815 
      0.000012058    -0.0080113    -0.0059431     -0.018413      0.026879 
        0.0020750      0.045454     -0.041393     -0.036752    -0.0091603 
        -0.030947     -0.045279     -0.059562     -0.095468 
      0.000021709     -0.014423     -0.010700     -0.033149      0.048392 
        0.0037357      0.081834     -0.074522     -0.066167     -0.016492 
        -0.055717     -0.081519      -0.10723      -0.17188 
;

load(type=symmetri,nrow=14,ncol=14) omega ;
 0.17239
-0.010572     0.0014150
-0.17239      0.010572       3.16743
-0.0074916    0.00018562     0.0074916     0.0070007
-0.0031285    0.000010588    0.0031285     0.00022894    0.00065834
-0.0031285    0.000010588    0.0031285     0.00022894    0.000049170  0.00065834
-0.00092313  -0.000084345    0.00092313    0.000031271  
-0.00026187  -0.000026062  0.00033493
-0.00092313  -0.000084345    0.00092313    0.000031271  
-0.000026062   -0.00026187   0.000026664    0.00033493
 0.010572    -0.0014150     -0.051875     -0.00018562   -0.000010588  -0.000010588  0.000084345    0.000084345   0.091625
 0.0074916   -0.00018562    -0.21383      -0.0070007    -0.00022894   -0.00022894  -0.000031271   -0.000031271  -0.015692      0.10943
 0.0031285   -0.000010588   -0.096966     -0.00022894   -0.00065834  -0.000049170  0.00026187     0.000026062  -0.0073745     0.0073488     
 0.032611
 0.0031285   -0.000010588   -0.096966     -0.00022894   
 -0.000049170   -0.00065834   0.000026062    0.00026187   
 -0.0073745     0.0073488   -0.013233     0.032611
 0.00092313   0.000084345   -0.038011     -0.000031271   0.00026187
 0.000026062 -0.00033493    -0.000026664  -0.017902      0.0063754    
-0.016815     0.013988       0.022922
 0.00092313   0.000084345   -0.038011     -0.000031271   0.000026062      0.00026187  -0.000026664   -0.00033493  
  -0.017902      0.0063754     0.013988    -0.016815      -0.0076759     0.022922
;

? need to get sigma + (db/da)omega(db/da)' = V

mat xx = dbda*omega*dbda';
mat v = sigma + dbda*omega*dbda';

print sigma;
print xx;
print v;
