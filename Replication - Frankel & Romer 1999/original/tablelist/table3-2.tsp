noprint;
supres @smpl;
options limwarn=0;
freq n;
smpl 1 150;

read(file='allgeog.dat') codesj geogt geog1 geog2 geog3 
geog4 geog5 geog6 geog7 geog8 geog9 geog10 
geog11 geog12 geog13 geog14;
read(file='area150.dat') code area;
read(file='popwork150.dat') code pop work;
read(file='info150.dat') code1 gdpw85 gdpw60 avinv 
ngdelta avsch open;

genr larea = log(area);
genr lwork = log(work);
genr lgdpw85 = log(gdpw85);

inst lgdpw85 c open lwork larea invr c geogt lwork larea;
copy @vcov sigma;

load(type=general,nrow=4,ncol=14) dbda ;
-0.00057876      -2.63268       1.45243       2.76694      -0.62072 
    1.39565      -3.05350       2.37890       8.70925       1.50419 
    7.29491      14.96390      11.54836      18.95934 
2.64781D-06      0.012044    -0.0066448     -0.012659     0.0028398 
 -0.0063851      0.013970     -0.010883     -0.039845    -0.0068817 
  -0.033374     -0.068460     -0.052834     -0.086739 
0.000016830      0.076557     -0.042236     -0.080461      0.018050 
  -0.040584      0.088794     -0.069177      -0.25326     -0.043741 
   -0.21213      -0.43514      -0.33582      -0.55133 
0.000023656       0.10761     -0.059366      -0.11309      0.025371 
  -0.057045       0.12481     -0.097234      -0.35598     -0.061482 
   -0.29817      -0.61163      -0.47202      -0.77493 
;

load(type=symmetri,nrow=14,ncol=14) omega ;
 0.17239
-0.010572     0.0014150
-0.17239      0.010572       3.16743
-0.0074916    0.00018562     0.0074916     0.0070007
-0.0031285    0.000010588    0.0031285     0.00022894    0.00065834
-0.0031285    0.000010588    0.0031285     0.00022894    0.000049170 0.00065834
-0.00092313  -0.000084345    0.00092313    0.000031271 
 -0.00026187  -0.000026062  0.00033493
-0.00092313  -0.000084345    0.00092313    0.000031271  
-0.000026062   -0.00026187   0.000026664    0.00033493
 0.010572    -0.0014150     -0.051875     -0.00018562   -0.000010588  -0.000010588  0.000084345    0.000084345   0.091625
 0.0074916   -0.00018562    -0.21383      -0.0070007    -0.00022894   -0.00022894  -0.000031271   -0.000031271  -0.015692      0.10943
 0.0031285   -0.000010588   -0.096966     -0.00022894   -0.00065834  -0.000049170  0.00026187     0.000026062  -0.0073745     0.0073488     
 0.032611
 0.0031285   -0.000010588   -0.096966     -0.00022894   
 -0.000049170   -0.00065834   0.000026062    0.00026187   
 -0.0073745     0.0073488   -0.013233     0.032611
 0.00092313   0.000084345   -0.038011     -0.000031271   0.00026187
 0.000026062 -0.00033493    -0.000026664  -0.017902      0.0063754    
-0.016815     0.013988       0.022922
 0.00092313   0.000084345   -0.038011     -0.000031271   0.000026062      0.00026187  -0.000026664   -0.00033493  
  -0.017902      0.0063754     0.013988    -0.016815      -0.0076759     0.022922
;

? need to get sigma + (db/da)omega(db/da)' = V

mat xx = dbda*omega*dbda';
mat v = sigma + dbda*omega*dbda';

print sigma;
print xx;
print v;
