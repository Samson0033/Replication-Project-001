noprint;
supres @smpl;
options limwarn=0;
freq n;
smpl 1 98;

read(file='allgeog98.dat') codesj geogt geog1 geog2 
geog3 geog4 geog5 geog6 geog7 geog8 geog9 
geog10 geog11 geog12 geog13 geog14;
read(file='area98.dat') code area;
read(file='popwork98.dat') code pop work;
read(file='info98.dat') code1 code2 code3 
gdpw85 gdpw60 avinv ngdelta avsch open;
read(file='hj98.dat') code1 code2 alnky phis lna;

genr lwork = log(work);
genr larea = log(area);
genr lgdpw85 = log(gdpw85);
genr lgdpw60 = log(gdpw60);
genr lgrow = lgdpw85 - lgdpw60;

inst lgrow c open lwork larea invr c geogt lwork larea;
copy @vcov sigma;

load(type=general,nrow=4,ncol=14) dbda ;
       0.00010883       2.72987      -0.68385      -0.61736       1.04087 
          5.89347     -16.12488       4.21842      -2.97621      -0.55322 
         -3.93290      -2.18246     -12.32811      -4.58902 
     -4.35974D-07     -0.010936     0.0027395     0.0024731    
     -0.0041697 
        -0.023609      0.064596     -0.016899      0.011923     0.0022162 
         0.015755     0.0087429      0.049386      0.018384 
     -2.80938D-06     -0.070469      0.017653      0.015937     -0.026869 
         -0.15214       0.41625      -0.10889      0.076828      0.014281 
          0.10152      0.056338       0.31824       0.11846 
     -5.05788D-06      -0.12687      0.031782      0.028692     -0.048374 
         -0.27390       0.74940      -0.19605       0.13832      0.025711 
          0.18278       0.10143       0.57295       0.21327 
;

load(type=symmetri,nrow=14,ncol=14) omega ;
 0.17239
-0.010572     0.0014150
-0.17239      0.010572       3.16743
-0.0074916    0.00018562     0.0074916     0.0070007
-0.0031285    0.000010588    0.0031285     0.00022894    0.00065834
-0.0031285    0.000010588    0.0031285     0.00022894    0.000049170  0.00065834
-0.00092313  -0.000084345    0.00092313    0.000031271  
-0.00026187  -0.000026062  0.00033493
-0.00092313  -0.000084345    0.00092313    0.000031271  
-0.000026062   -0.00026187   0.000026664    0.00033493
 0.010572    -0.0014150     -0.051875     -0.00018562   -0.000010588  -0.000010588  0.000084345    0.000084345   0.091625
 0.0074916   -0.00018562    -0.21383      -0.0070007    -0.00022894   -0.00022894  -0.000031271   -0.000031271  -0.015692      0.10943
 0.0031285   -0.000010588   -0.096966     -0.00022894   -0.00065834  -0.000049170  0.00026187     0.000026062  -0.0073745     0.0073488     
 0.032611
 0.0031285   -0.000010588   -0.096966     -0.00022894   
 -0.000049170   -0.00065834   0.000026062    0.00026187   
 -0.0073745     0.0073488   -0.013233     0.032611
 0.00092313   0.000084345   -0.038011     -0.000031271   0.00026187
 0.000026062 -0.00033493    -0.000026664  -0.017902      0.0063754    
-0.016815     0.013988       0.022922
 0.00092313   0.000084345   -0.038011     -0.000031271   0.000026062      0.00026187  -0.000026664   -0.00033493   
 -0.017902      0.0063754      0.013988    -0.016815      -0.0076759     0.022922
;

? need to get sigma + (db/da)omega(db/da)' = V

mat xx = dbda*omega*dbda';
mat v = sigma + dbda*omega*dbda';

print sigma;
print xx;
print v;
