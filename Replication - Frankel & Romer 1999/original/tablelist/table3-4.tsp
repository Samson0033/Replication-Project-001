noprint;
supres @smpl;
options limwarn=0;
freq n;
smpl 1 98;

read(file='allgeog98.dat') codesj geogt geog1 geog2 
geog3 geog4 geog5 geog6 geog7 geog8 geog9 
geog10 geog11 geog12 geog13 geog14;
read(file='area98.dat') code area;
read(file='popwork98.dat') code pop work;
read(file='info98.dat') code1 code2 code3 gdpw85 
gdpw60 avinv ngdelta avsch open;

genr lwork = log(work);
genr larea = log(area);
genr lgdpw85 = log(gdpw85);

inst lgdpw85 c open lwork larea invr c geogt lwork larea;
copy @vcov sigma;

load(type=general,nrow=4,ncol=14) dbda ;
  -0.0016406       4.87781       0.13295       3.50702      -2.64294 
    12.04650     -23.54022      15.01526       4.04803       1.17908 
    -1.07133       7.25427      -5.75938      12.11446 
 6.57204D-06     -0.019540   -0.00053258     -0.014049      0.010588 
   -0.048258      0.094302     -0.060151     -0.016216    -0.0047234 
   0.0042917     -0.029060      0.023072     -0.048530 
 0.000042350      -0.12592    -0.0034319     -0.090531      0.068225 
    -0.31097       0.60767      -0.38761      -0.10450     -0.030437 
    0.027656      -0.18726       0.14867      -0.31273 
 0.000076244      -0.22669    -0.0061786      -0.16299       0.12283 
    -0.55986       1.09403      -0.69783      -0.18813     -0.054797 
    0.049790      -0.33714       0.26767      -0.56302 
;

load(type=symmetri,nrow=14,ncol=14) omega ;
 0.17239
-0.010572     0.0014150
-0.17239      0.010572       3.16743
-0.0074916    0.00018562     0.0074916     0.0070007
-0.0031285    0.000010588    0.0031285     0.00022894    0.00065834
-0.0031285    0.000010588    0.0031285     0.00022894    0.000049170  0.00065834
-0.00092313  -0.000084345    0.00092313    0.000031271  
-0.00026187  -0.000026062  0.00033493
-0.00092313  -0.000084345    0.00092313    0.000031271  
-0.000026062   -0.00026187   0.000026664    0.00033493
 0.010572    -0.0014150     -0.051875     -0.00018562   -0.000010588  -0.000010588  0.000084345    0.000084345   0.091625
 0.0074916   -0.00018562    -0.21383      -0.0070007    -0.00022894   -0.00022894  -0.000031271   -0.000031271  -0.015692      0.10943
 0.0031285   -0.000010588   -0.096966     -0.00022894   -0.00065834  -0.000049170  0.00026187     0.000026062  -0.0073745     0.0073488     
 0.032611
 0.0031285   -0.000010588   -0.096966     -0.00022894   
 -0.000049170   -0.00065834   0.000026062    0.00026187   
 -0.0073745     0.0073488   -0.013233     0.032611
 0.00092313   0.000084345   -0.038011     -0.000031271   0.00026187
 0.000026062 -0.00033493    -0.000026664  -0.017902      0.0063754    
-0.016815     0.013988       0.022922
 0.00092313   0.000084345   -0.038011     -0.000031271   0.000026062      0.00026187  -0.000026664   -0.00033493   -0.017902      0.0063754     0.013988    -0.016815      -0.0076759     0.022922
;

? need to get sigma + (db/da)omega(db/da)' = V

mat xx = dbda*omega*dbda';
mat v = sigma + dbda*omega*dbda';

print sigma;
print xx;
print v;
