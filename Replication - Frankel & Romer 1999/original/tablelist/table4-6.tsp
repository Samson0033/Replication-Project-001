noprint;
supres @smpl;
options limwarn=0;
freq n;
smpl 1 98;

read(file='allgeog98.dat') codesj geogt geog1 geog2 
geog3 geog4 geog5 geog6 geog7 geog8 geog9 
geog10 geog11 geog12 geog13 geog14;
read(file='area98.dat') code area;
read(file='popwork98.dat') code pop work;
read(file='info98.dat') code1 code2 code3 
gdpw85 gdpw60 avinv ngdelta avsch open;
read(file='hj98.dat') code1 code2 alnky phis lna;

genr lwork = log(work);
genr larea = log(area);
genr lgdpw85 = log(gdpw85);
genr lgdpw60 = log(gdpw60);
genr lgrow = lgdpw85 - lgdpw60;

inst lna c open lwork larea invr c geogt lwork larea;
copy @vcov sigma;

load(type=general,nrow=4,ncol=14) dbda ;
       -0.0010281       4.21251      -0.17338       2.64831      -1.75841 
         10.48297     -16.67792      11.32116       2.35753       0.98156 
         -2.44389       4.42483      -6.71242       6.44399 
      4.11864D-06     -0.016875    0.00069456     -0.010609     0.0070442 
        -0.041995      0.066811     -0.045352    -0.0094442    -0.0039321 
        0.0097902     -0.017726      0.026890     -0.025815 
      0.000026540      -0.10874     0.0044757     -0.068364      0.045392 
         -0.27061       0.43053      -0.29225     -0.060858     -0.025338 
         0.063087      -0.11422       0.17328      -0.16635 
      0.000047782      -0.19578     0.0080579      -0.12308      0.081722 
         -0.48719       0.77510      -0.52615      -0.10957     -0.045618 
          0.11358      -0.20564       0.31196      -0.29948 
;

load(type=symmetri,nrow=14,ncol=14) omega ;
 0.17239
-0.010572     0.0014150
-0.17239      0.010572       3.16743
-0.0074916    0.00018562     0.0074916     0.0070007
-0.0031285    0.000010588    0.0031285     0.00022894    0.00065834
-0.0031285    0.000010588    0.0031285     0.00022894    0.000049170  0.00065834
-0.00092313  -0.000084345    0.00092313    0.000031271 
 -0.00026187  -0.000026062  0.00033493
-0.00092313  -0.000084345    0.00092313    0.000031271  
-0.000026062   -0.00026187   0.000026664    0.00033493
 0.010572    -0.0014150     -0.051875     -0.00018562   -0.000010588  -0.000010588  0.000084345    0.000084345   0.091625
 0.0074916   -0.00018562    -0.21383      -0.0070007    -0.00022894   -0.00022894  -0.000031271   -0.000031271  -0.015692      0.10943
 0.0031285   -0.000010588   -0.096966     -0.00022894   -0.00065834  -0.000049170  0.00026187     0.000026062  -0.0073745     0.0073488     
 0.032611
 0.0031285   -0.000010588   -0.096966     -0.00022894   
 -0.000049170   -0.00065834   0.000026062    0.00026187   
 -0.0073745     0.0073488   -0.013233     0.032611
 0.00092313   0.000084345   -0.038011     -0.000031271   0.00026187
 0.000026062 -0.00033493    -0.000026664  -0.017902      0.0063754    
-0.016815     0.013988       0.022922
 0.00092313   0.000084345   -0.038011     -0.000031271   0.000026062      0.00026187  -0.000026664   -0.00033493  
  -0.017902      0.0063754     0.013988    -0.016815      -0.0076759     0.022922
;

? need to get sigma + (db/da)omega(db/da)' = V

mat xx = dbda*omega*dbda';
mat v = sigma + dbda*omega*dbda';

print sigma;
print xx;
print v;
