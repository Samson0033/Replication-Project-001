noprint;
supres @smpl;
options limwarn=0;
freq n;
smpl 1 98;

read(file='allgeog98.dat') codesj geogt geog1 geog2 
geog3 geog4 geog5 geog6 geog7 geog8 geog9 
geog10 geog11 geog12 geog13 geog14;
read(file='area98.dat') code area;
read(file='popwork98.dat') code pop work;
read(file='info98.dat') code1 code2 code3 
gdpw85 gdpw60 avinv ngdelta avsch open;
read(file='hj98.dat') code1 code2 alnky phis lna;

genr lwork = log(work);
genr larea = log(area);
genr lgdpw85 = log(gdpw85);
genr lgdpw60 = log(gdpw60);
genr lgrow = lgdpw85 - lgdpw60;

inst lgdpw60 c open lwork larea invr c geogt lwork larea;
copy @vcov sigma;

load(type=general,nrow=4,ncol=14) dbda ;
       -0.0017494       2.14793       0.81679       4.12438      -3.68381 
          6.15303      -7.41534      10.79685       7.02423       1.73229 
          2.86157       9.43673       6.56872      16.70348 
      7.00801D-06    -0.0086046    -0.0032721     -0.016522      0.014757 
        -0.024649      0.029706     -0.043252     -0.028139    -0.0069395 
        -0.011463     -0.037803     -0.026314     -0.066914 
      0.000045159     -0.055447     -0.021085      -0.10647      0.095095 
         -0.15884       0.19142      -0.27871      -0.18132     -0.044718 
        -0.073869      -0.24360      -0.16957      -0.43119 
      0.000081302     -0.099825     -0.037960      -0.19168       0.17120 
         -0.28596       0.34463      -0.50178      -0.32645     -0.080508 
         -0.13299      -0.43857      -0.30528      -0.77629 
;

load(type=symmetri,nrow=14,ncol=14) omega ;
 0.17239
-0.010572     0.0014150
-0.17239      0.010572       3.16743
-0.0074916    0.00018562     0.0074916     0.0070007
-0.0031285    0.000010588    0.0031285     0.00022894    0.00065834
-0.0031285    0.000010588    0.0031285     0.00022894    0.000049170  0.00065834
-0.00092313  -0.000084345    0.00092313    0.000031271 
 -0.00026187  -0.000026062  0.00033493
-0.00092313  -0.000084345    0.00092313    0.000031271  
-0.000026062   -0.00026187   0.000026664    0.00033493
 0.010572    -0.0014150     -0.051875     -0.00018562   -0.000010588  -0.000010588  0.000084345    0.000084345   0.091625
 0.0074916   -0.00018562    -0.21383      -0.0070007    -0.00022894   -0.00022894  -0.000031271   -0.000031271  -0.015692      0.10943
 0.0031285   -0.000010588   -0.096966     -0.00022894   -0.00065834  -0.000049170  0.00026187     0.000026062  -0.0073745     0.0073488     
 0.032611
 0.0031285   -0.000010588   -0.096966     -0.00022894   
 -0.000049170   -0.00065834   0.000026062    0.00026187   
 -0.0073745     0.0073488   -0.013233     0.032611
 0.00092313   0.000084345   -0.038011     -0.000031271   0.00026187
 0.000026062 -0.00033493    -0.000026664  -0.017902      0.0063754    
-0.016815     0.013988       0.022922
 0.00092313   0.000084345   -0.038011     -0.000031271   0.000026062      0.00026187  -0.000026664   -0.00033493  
  -0.017902      0.0063754     0.013988    -0.016815      -0.0076759     0.022922
;

? need to get sigma + (db/da)omega(db/da)' = V

mat xx = dbda*omega*dbda';
mat v = sigma + dbda*omega*dbda';

print sigma;
print xx;
print v;
